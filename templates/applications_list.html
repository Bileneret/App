{% extends "base.html" %}
{% block title %}–ú–æ—ó –∑–∞—è–≤–∫–∏{% endblock %}

{% block content %}
<h1>–ú–æ—ó –∑–∞—è–≤–∫–∏</h1>

<p>
    <a href="{{ url_for('create_application') }}" class="action-btn-unified btn-green">
        + –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É –∑–∞—è–≤–∫—É
    </a>
</p>

{% if applications %}
    <table border="0" cellpadding="6" cellspacing="0" style="width: 100%;">
        <thead>
            <tr>
                <th align="left">ID</th>
                <th align="left">–ù–∞–∑–≤–∞</th>
                <th align="left">–°—Ç–∞—Ç—É—Å</th>
                <th align="left">–°—Ç–≤–æ—Ä–µ–Ω–∞</th>
                <th align="left">–î—ñ—ó</th>
            </tr>
        </thead>
        <tbody>
        {% for app in applications %}
            <tr>
                <td>{{ app.id }}</td>
                <td>{{ app.title }}</td>
                <td>
                    {% if app.status == 'draft' %}
                        <span class="status-badge status-draft">üìù –ß–µ—Ä–Ω–µ—Ç–∫–∞</span>
                    {% elif app.status == 'submitted' %}
                        <span class="status-badge status-submitted">‚è≥ –ù–∞ —Ä–æ–∑–≥–ª—è–¥—ñ</span>
                    {% elif app.status == 'needs_changes' %}
                        <span class="status-badge status-needs-changes">‚ö†Ô∏è –ü–æ—Ç—Ä–µ–±—É—î –∑–º—ñ–Ω</span>
                    {% elif app.status == 'approved' %}
                        <span class="status-badge status-approved">‚úÖ –°—Ö–≤–∞–ª–µ–Ω–æ</span>
                    {% elif app.status == 'rejected' %}
                        <span class="status-badge status-rejected">‚ùå –í—ñ–¥—Ö–∏–ª–µ–Ω–æ</span>
                    {% elif app.status == 'cancelled' %}
                        <span class="status-badge status-cancelled">üö´ –°–∫–∞—Å–æ–≤–∞–Ω–æ</span>
                    {% else %}
                        <span class="status-badge">{{ app.status }}</span>
                    {% endif %}
                </td>
                <td>{{ app.created_at.strftime('%Y-%m-%d') }}</td>
                <td style="display: flex; gap: 5px; flex-wrap: wrap; align-items: center;">

                    <a href="{{ url_for('view_application', application_id=app.id) }}"
                       class="action-btn-unified btn-blue">
                       –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏
                    </a>

                    {% if app.status in ("draft", "needs_changes") %}
                        <a href="{{ url_for('edit_application', application_id=app.id) }}"
                           class="action-btn-unified btn-yellow">
                           –†–µ–¥–∞–≥—É–≤–∞—Ç–∏
                        </a>

                        <form action="{{ url_for('submit_application', application_id=app.id) }}"
                                method="post" style="margin:0;">
                            <button type="submit" class="action-btn-unified btn-green"
                                    onclick="return confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –ø–æ–¥–∞—Ç–∏ —Ü—é –∑–∞—è–≤–∫—É?');">
                                –ü–æ–¥–∞—Ç–∏
                            </button>
                        </form>

                    {% elif app.status == "submitted" %}
                        <form action="{{ url_for('cancel_application', application_id=app.id) }}"
                                method="post" style="margin:0;">
                            <button type="submit" class="action-btn-unified btn-red"
                                    onclick="return confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ —Å–∫–∞—Å—É–≤–∞—Ç–∏ —Ü—é –∑–∞—è–≤–∫—É?');">
                                –°–∫–∞—Å—É–≤–∞—Ç–∏
                            </button>
                        </form>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% else %}
    <p>–£ –≤–∞—Å —â–µ –Ω–µ–º–∞—î –∂–æ–¥–Ω–æ—ó –∑–∞—è–≤–∫–∏.</p>
{% endif %}
{% endblock %}