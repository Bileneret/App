{% extends "base.html" %}
{% block title %}Заявка №{{ application.id }}{% endblock %}

{% block content %}
<h1>Заявка №{{ application.id }}</h1>

<p><strong>Назва:</strong> {{ application.title }}</p>
<p><strong>Статус:</strong> {{ application.status }}</p>
<p><strong>Дата створення:</strong> {{ application.created_at }}</p>
<p><strong>Останнє оновлення:</strong> {{ application.updated_at }}</p>

<h2>Короткий опис</h2>
<p style="white-space: pre-wrap;">{{ application.short_description }}</p>

<hr>

{% if g.user.id == application.owner_id %}
    {% if application.status in ("draft", "needs_changes") %}
        <p>
            <a href="{{ url_for('edit_application', application_id=application.id) }}">Редагувати</a>
        </p>
        <form action="{{ url_for('submit_application', application_id=application.id) }}"
              method="post">
            <button type="submit">Подати на розгляд</button>
        </form>

    {% elif application.status == "submitted" %}
        <p>Заявку подано на розгляд. Ви можете її скасувати, доки рішення ще не прийнято.</p>
        <form action="{{ url_for('cancel_application', application_id=application.id) }}"
              method="post">
            <button type="submit" style="background:#b91c1c;">Скасувати заявку</button>
        </form>

    {% elif application.status == "cancelled" %}
        <p>Цю заявку було скасовано. Вона зберігається в історії, але недоступна для подальшого опрацювання.</p>

    {% else %}
        <p>Заявку вже опрацьовано (статус: {{ application.status }}), скасування недоступне.</p>
    {% endif %}
{% endif %}

<p>
    <a href="{{ url_for('my_applications') }}">Повернутися до списку</a>
</p>
{% endblock %}